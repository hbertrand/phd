%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                        INTRODUCTION                                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}
\label{chap:intro}

% \begin{chapabstract}
%  Coucou
% \end{chapabstract}

% \vspace{1cm}

% {   
%     \setstretch{1.0}
%     \minitoc
% }

% \newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Context}

This thesis is at the cross-road of medical image analysis and deep learning, and explores how the recent advances in deep learning can be leveraged to improve the performance on tasks where traditional computer vision methods were insufficient. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Medical Imaging}

%Medical imaging is the set of methods allowing to reconstruct the inside of the body in a non-invasive way. It is routinely used by clinicians for diagnosis and surgical planning. Many modalities of images are available, based on different physical principles and each offering different advantages and drawbacks that answer a variety of needs. 

Automated methods have been developed to analyze medical images in order to facilitate the work of the clinicians. Tasks such as segmentation or localization of various body parts and organs, registration between frames of a temporal sequence or slices of a 3D image, or detection of tumors are well-suited to computer vision methods.

While computer vision methods developed for natural images can be reused, the specificity of medical images should be taken into account. Unlike natural images, medical images have no background, a more limited scope in the objects that are represented, no colors and an intensity that often has a precise meaning depending on the modality.

While these may seem to make the problem simpler at first glance, challenges in medical image analysis come in two categories. The first challenge is variability, either intra-subject (changes in the body with time, or during image acquisition as the patient breathes and moves) or inter-subject (in the shape, size and location of bones and organs). Variability also comes from external sources: patterns of noise specific to a machine, image resolution and contrasts depending on the image protocol, field-of-view depending on how the clinicians handle the probe ... 

The second challenge comes from the difficulty of acquiring data and therefore the low amount of data available. This difficulty is caused by the time and expertise required for the acquisition itself, the sensitivity of the data that adds ethical, administrative and bureaucratic overhead, and sometimes the rarity of a disease.\footnote{Initiatives are underway to create big and accessible medical images databases. (See for examples the \href{https://www.nlm.nih.gov/NIHbmic/nih_data_sharing_repositories.html}{NIH Data Sharing Repositories} or the \href{https://www.kaggle.com/datasets?tagids=4202}{Kaggle Healthcare datasets})}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Deep Learning}

These last few years, it has been impossible to talk about medical image analysis without talking about deep learning. The inescapable transformation brought with deep learning was made possible with the advent of cheap memory storage and computing power. %It is not, however, the first time artificial neural networks where applied to medical imaging problems.  

This change brought with it its own set of challenges. The huge amount of resources invested into the field results in a deluge of publications where it is difficult to keep up-to-date and separate the noise from the actual progress.

To give some perspectives on the progress, at the start of this thesis in early 2016: 
\begin{itemize}
    \item Tensorflow (\textcite{tensorflow2015}) was just released and a nightmare to install - now it works everywhere from desktop to smartphone and has been cited in over 5000 papers.
    \item The original GAN paper by Goodfellow \textit{et al} was published mid 2014 (\textcite{goodfellow2014}). Early 2016, GANs had the reputation of being incredibly difficult to train and unusable outside of toy datasets. Three years and 5000 citations later, GANs have been applied to a wide range of domains, including medical imaging.
    \item The omnipresent U-Net architecture had just made its debut a few months earlier at MICCAI 2015.
\end{itemize}

In the context of medical imaging, deep learning also brings technical challenges. Two of the most common criticisms are the lack of interpretability of neural networks and the lack of robustness. They are barriers to the adoption of deep learning in clinical use and resolving those issues would open the doors to new tasks such as diagnosis or surgical intervention. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Contributions}

During this thesis we explored a range of problems, from theoretical to applied. This work contains the following contributions (listed in the order they appear in the thesis):
\begin{itemize}
    \item A performance improvement of Bayesian optimization by using an incremental Cholesky decomposition. Chapter~\ref{chap:hyperopt}, Section~\ref{sec:cholesky}.
    \item A theoretical bound on the performance of random search. Chapter~\ref{chap:hyperopt}, Section~\ref{sec:compare}.
    \item A new hyper-parameter optimization method combining Hyperband and Bayesian optimization. Chapter~\ref{chap:hyperopt}, Section~\ref{sec:cap}. Published as~\textcite{bertrand2017CAp}.
    \item A method to solve a classification problem of MRI field-of-view. Chapter~\ref{chap:hyperopt}, Section~\ref{sec:isbi}. Published as~\textcite{bertrand2017ISBI}.
    \item A new transfer learning method and its application to the segmentation of the kidney in 3D ultrasound images. Chapter~\ref{chap:transfer}. Filled as a patent, under review.
    \item A statistical shape model approach using deep learning. Chapter~\ref{chap:seg}.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Outline}

This thesis is structured in three parts, each starting with a review of the relevant literature.

Chapter~\ref{chap:hyperopt} discusses the topic of hyper-parameter optimization in the context of deep learning. We focus on three methods: random search, Bayesian optimization and Hyperband, presenting a performance comparison, an improvement and a method combining them. The chapter ends with an application to the problem of MRI field-of-view classification.

Chapter~\ref{chap:transfer} introduces a new transfer learning methods in order to solve the task of segmenting the kidney in 3D ultrasound across two populations: healthy adults and sick children.

Chapter~\ref{chap:seg} also deals with to the segmentation of the kidney, but using a statistical shape model and a neural network predicting a deformation field for the model.

Chapter~\ref{chap:conclusion} summarizes our conclusions and discusses possible future works.
